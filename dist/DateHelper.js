"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _IUtilityTypes=require("./IUtilityTypes"),_NumberHelper=_interopRequireDefault(require("./NumberHelper")),_ErrorHelper=_interopRequireDefault(require("./ErrorHelper"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var DateHelper=function(){function g(){_classCallCheck(this,g)}return _createClass(g,null,[{key:"_fixDate",value:function(e,t){if(+e)for(;e.getDate()!==t.getDate();)e.setTime(+e+36e5*(e<t?1:-1))}},{key:"parseISO8601",value:function(e){var t=e.match(g._isoDateFormatExp);if(!t)return(t=e.match(g._isoDateFormatExp2))?new Date(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10)):(t=e.match(g._isoDateFormatExp3))?new Date(parseInt(t[1],10),parseInt(t[2],10)-1):(t=e.match(g._isoDateFormatExp4))?new Date(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10)):(t=e.match(g._isoDateFormatExp5))?new Date(parseInt(t[3],10),parseInt(t[1],10)-1,parseInt(t[2],10)):null;var r=parseInt(t[1],10),n=new Date(r,0,1);if(t[14]){r=parseInt(t[3],10),n.setUTCFullYear(parseInt(t[1],10),r?r-1:0,parseInt(t[5],10)||1),n.setUTCHours(parseInt(t[7],10)||0,parseInt(t[8],10)||0,parseInt(t[10],10)||0,parseInt(t[12],10)?1e3*Number("0."+t[12]):0),r=parseInt(t[18],10);var a=60*parseInt(t[16],10)+(r||0);a*="-"===t[15]?1:-1,n=new Date(+n+60*a*1e3)}else{var s=new Date(r,0,1,9,0);t[3]&&(r=parseInt(t[3],10),n.setMonth(r-1),s.setMonth(r-1)),t[5]&&(r=parseInt(t[5],10),n.setDate(r),s.setDate(r)),g._fixDate(n,s),t[7]&&n.setHours(parseInt(t[7],10)),t[8]&&n.setMinutes(parseInt(t[8],10)),t[10]&&n.setSeconds(parseInt(t[10],10)),t[12]&&n.setMilliseconds(1e3*Number("0."+t[12])),g._fixDate(n,s)}return n}},{key:"parse",value:function(e){if(!e)return null;var t;switch(_typeof(e)){case"number":return(t=new Date(1e3*Number(e))).getTime()!==e?null:t;case"string":var r=e.match(g._dateFormatExp);if(r)return new Date(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],0));if(r=e.match(g._dateFormatExp2))return new Date(parseInt(r[1],10),parseInt(r[2],10)-1);if(e.match(g._dateFormatExp3)){var n=parseInt(e,10);return(t=new Date(1e3*n)).getTime()!==n?null:t}return g.parseISO8601(e)||(e?new Date(e):null);default:return e.getFullYear?e:null}}},{key:"format",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd";if(!e)return"";switch(_typeof(e)){case"string":e=g.parse(e);break;case"number":if(new Date(1e3*Number(e)).getTime()!==Number(e))return"";break;case"object":if(!e.getFullYear)return e.toString();break;default:return e}var r,n,a,s,i,u=e.getFullYear(),o=e.getMonth(),l=e.getDate();switch(t){case"yyyy-MM-dd":case"yyyy-mm-dd":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),u+"-"+r+"-"+n;case"MM-dd":case"mm-dd":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),r+"-"+n;case"yyyy-MM-dd HH:mm":case"yyyy-mm-dd hh:ii":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),u+"-"+r+"-"+n+" "+a+":"+s;case"yyyy-MM":case"yyyy-mm":return 1===(r=(o+1).toString()).length&&(r="0"+r),u+"-"+r;case"yyyy":return u.toString();case"HH:mm:ss":case"hh:ii:ss":return 1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),1===(i=e.getSeconds().toString()).length&&(i="0"+i),a+":"+s+":"+i;case"MM-dd HH:mm:ss":case"mm-dd hh:ii:ss":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),1===(i=e.getSeconds().toString()).length&&(i="0"+i),r+"-"+n+" "+a+":"+s+":"+i;case"yyyy-MM-dd HH:mm:ss":case"yyyy-mm-dd hh:ii:ss":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),1===(i=e.getSeconds().toString()).length&&(i="0"+i),u+"-"+r+"-"+n+" "+a+":"+s+":"+i;case"yyyy/MM/dd HH:mm:ss":case"yyyy/mm/dd hh:ii:ss":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),1===(i=e.getSeconds().toString()).length&&(i="0"+i),u+"/"+r+"/"+n+" "+a+":"+s+":"+i;case"MM/dd HH:mm":case"mm/dd hh:ii":return 1===(r=(o+1).toString()).length&&(r="0"+r),1===(n=l.toString()).length&&(n="0"+n),1===(a=e.getHours().toString()).length&&(a="0"+a),1===(s=e.getMinutes().toString()).length&&(s="0"+s),1===(i=e.getSeconds().toString()).length&&(i="0"+i),r+"/"+n+" "+a+":"+s}return""}},{key:"formatDate",value:function(e){if(!e)return e;e=(e=e.toString()).replace(/-/g,"/");var t=new Date,r=new Date(e),n=g.format(r,"MM-dd");return r.getFullYear()!==t.getFullYear()&&(n=g.format(r,"yyyy-MM-dd")),n}},{key:"formatDateTime",value:function(e){if(!e)return e;e=(e=e.toString()).replace(/-/g,"/");var t=new Date,r=new Date(e),n=Number(t)-Number(r);return n<6e4?"刚刚":6e4<=n&&n<36e5?Math.ceil(n/6e4)+"分钟前":36e5<=n&&n<864e5?Math.ceil(n/36e5)+"小时前":r.getFullYear()<t.getFullYear()?g.format(r,"yyyy-MM-dd HH:mm:ss"):r.getDate()===t.getDate()&&r.getMonth()===t.getMonth()?g.format(r,"HH:mm:ss"):g.format(r,"MM-dd HH:mm:ss")}},{key:"diff",value:function(e,t,r){var n=g.parse(e),a=g.parse(t);if(!n)throw _ErrorHelper.default.argumentNull("left","参数值必须是一个日期对象或者是一个可以转换成日期对象的数值或字符串。");if(!a)throw _ErrorHelper.default.argumentNull("right","参数值必须是一个日期对象或者是一个可以转换成日期对象的数值或字符串。");switch(r){case _IUtilityTypes.DatePartEnum.year:return a.getFullYear()-n.getFullYear();case _IUtilityTypes.DatePartEnum.month:return 12*(a.getFullYear()-n.getFullYear())+a.getMonth()-n.getMonth();default:var s=(a.getTime()-n.getTime())/1e3;switch(r){case _IUtilityTypes.DatePartEnum.week:s=s/60/60/24/7;break;case _IUtilityTypes.DatePartEnum.day:s=s/60/60/24;break;case _IUtilityTypes.DatePartEnum.hour:s=s/60/60;break;case _IUtilityTypes.DatePartEnum.minute:s/=60}return _NumberHelper.default.unround(s)}}},{key:"add",value:function(e,t,r){var n=g.parse(e);if(!n)throw _ErrorHelper.default.argumentNull("left","参数值必须是一个日期对象或者是一个可以转换成日期对象的数值或字符串。");switch(t){case _IUtilityTypes.DatePartEnum.year:return new Date(n.getFullYear()+r,n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());case _IUtilityTypes.DatePartEnum.month:return new Date(n.getFullYear(),n.getMonth()+r,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());case _IUtilityTypes.DatePartEnum.day:return new Date(n.getTime()+864e5*r);case _IUtilityTypes.DatePartEnum.week:return new Date(n.getTime()+6048e5*r);case _IUtilityTypes.DatePartEnum.hour:return new Date(n.getTime()+36e5*r);case _IUtilityTypes.DatePartEnum.minute:return new Date(n.getTime()+6e4*r);case _IUtilityTypes.DatePartEnum.second:return new Date(n.getTime()+1e3*r)}return null}}]),g}();(exports.default=DateHelper)._dateFormatExp=/^([0-9]{4})([0-9]{2})([0-9]{2})$/,DateHelper._dateFormatExp2=/^([0-9]{4}).([0-9]*)$/,DateHelper._dateFormatExp3=/^\d+(\.\d+)?$/,DateHelper._isoDateFormatExp=/^([0-9]{4})([-\/]([0-9]{1,2})([-\/]([0-9]{1,2})([T ]([0-9]{1,2}):([0-9]{1,2})(:([0-9]{1,2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/,DateHelper._isoDateFormatExp2=/^([0-9]{4})[-\/]([0-9]{2})[-\/]([0-9]{2})[T ]([0-9]{1,2})/,DateHelper._isoDateFormatExp3=/^([0-9]{4}).([0-9]*)/,DateHelper._isoDateFormatExp4=/^([0-9]{4}).([0-9]*).([0-9]*)/,DateHelper._isoDateFormatExp5=/^([0-9]{2})-([0-9]{2})-([0-9]{4})$/;
//# sourceMappingURL=DateHelper.js.map
