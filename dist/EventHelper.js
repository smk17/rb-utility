"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _IUtilityTypes=require("./IUtilityTypes"),_index=require("./index"),_ConsoleHelper=_interopRequireDefault(require("./ConsoleHelper"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}var __awaiter=function(a,i,u,c){return new(u||(u=Promise))(function(e,r){function t(e){try{o(c.next(e))}catch(e){r(e)}}function n(e){try{o(c.throw(e))}catch(e){r(e)}}function o(r){r.done?e(r.value):new u(function(e){e(r.value)}).then(t,n)}o((c=c.apply(a,i||[])).next())})},EventHelper=function(){function c(){_classCallCheck(this,c)}return _createClass(c,[{key:"isLock",value:function(){return 0!==c._lockCount}}],[{key:"exec",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_ConsoleHelper.default,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"数据获取失败,请联系系统管理员！";return function(e,r,t){var o=t.value;return"function"==typeof o&&(t.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.apply(this,n);case 3:return r=e.sent,e.abrupt("return",r);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0&&(t=_IUtilityTypes.ErrorType.unknown,i=e.t0.message||i,!1===e.t0.success&&(i=e.t0.message,t=_IUtilityTypes.ErrorType.known,e.t0.errorType&&(t=e.t0.errorType)),a.error(i),_index.EventDriver.send("catchError",{errorText:i,errorType:t,errorMessage:e.t0})),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,7]])}))}),t}}},{key:"execLock",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_ConsoleHelper.default,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"未知错误";return function(e,r,t){var o=t.value;return"function"==typeof o&&(t.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.increaseLock(),e.next=4,o.apply(this,n);case 4:return r=e.sent,c.decreaseLock(),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),c.decreaseLock(),e.t0&&(t=_IUtilityTypes.ErrorType.unknown,i=e.t0.message||i,!1===e.t0.success&&(i=e.t0.message,t=_IUtilityTypes.ErrorType.known,e.t0.errorType&&(t=e.t0.errorType)),a.error(i),_index.EventDriver.send("catchError",{errorText:i,errorType:t,errorMessage:e.t0})),e.t0;case 14:case"end":return e.stop()}},e,this,[[0,9]])}))}),t}}},{key:"execSubmit",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_ConsoleHelper.default,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"保存成功",u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"未知错误";return function(e,r,t){var o=t.value;return"function"==typeof o&&(t.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c.increaseLock(),e.next=4,o.apply(this,n);case 4:return(r=e.sent)&&i?a.success(i,2,function(){c.decreaseLock()}):c.decreaseLock(),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),c.decreaseLock(),e.t0&&(t=_IUtilityTypes.ErrorType.unknown,u=e.t0.message||u,!1===e.t0.success&&(u=e.t0.message,t=_IUtilityTypes.ErrorType.known,e.t0.errorType&&(t=e.t0.errorType)),a.error(u),_index.EventDriver.send("catchError",{errorText:u,errorType:t,errorMessage:e.t0})),e.t0;case 14:case"end":return e.stop()}},e,this,[[0,9]])}))}),t}}},{key:"increaseLock",value:function(){c._lockCount++}},{key:"decreaseLock",value:function(){0<c._lockCount&&c._lockCount--}}]),c}();(exports.default=EventHelper)._lockCount=0;
//# sourceMappingURL=EventHelper.js.map
