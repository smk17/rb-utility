"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ErrorHelper=_interopRequireDefault(require("./ErrorHelper")),_TypeHelper=_interopRequireDefault(require("./TypeHelper"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}var NumberHelper=function(){function g(){_classCallCheck(this,g)}return _createClass(g,null,[{key:"parse",value:function(e){if(!e)return 0;switch(_typeof(e)){case"number":return Number(e);case"string":return 0<=(e=e.replace(/,/g,"")).indexOf(".")?parseFloat(e):parseInt(e,10);default:throw _ErrorHelper.default.argument("value","值必须是字符串或者数值。")}}},{key:"_isNumberFormat",value:function(e){return-1!==e.indexOf("0")||-1!==e.indexOf("#")}},{key:"_getNumberFormat",value:function(e){if(!e)return null;var r=e.indexOf("0"),t=e.indexOf("#");if((-1===r||-1!==t&&t<r)&&(r=t),r<0)return null;var n=e.lastIndexOf("0"),a=e.lastIndexOf("#");(-1===n||-1!==a&&n<a)&&(n=a);var u=e.lastIndexOf(".");return{begin:r,end:n,digits:u=0<u?n===a?6:n-u:0,format:e.substring(r,n+1)}}},{key:"_pad",value:function(e,r,t){var n=r-e.length;if(0<n){for(var a="";n;)n-=1,a+="0";return t?e+a:a+e}return e}},{key:"_doFormatNumber",value:function(e,r){e=Math.abs(e);var t=-1!==r.indexOf(","),n=r.split("."),a=(n[0]||"").replace(g._clearRegExp,""),u=(n[1]||"").replace(g._clearRegExp,""),o="",l=a.indexOf("0");a=-1===l?"0":a.substr(l)||"0";var i=u.length,f=u.substr(0,u.lastIndexOf("0")+1).length;e=g.round(e,i);var p=String(e).split("."),s=p[0],c=p[1]||"";if(s){if(s=g._pad(s,a.length),t)for(var d=0;d<Math.floor((s.length-(1+d))/3);d++)s=s.substring(0,s.length-(4*d+3))+","+s.substring(s.length-(4*d+3));o+=s}return 0<i&&(o+=".",o+=g._pad(c.substr(0,i),f,!0)),o}},{key:"round",value:function(e){var r,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(isNaN(e))return 0;if(_TypeHelper.default.isNumber(t)?t<0&&(t=0):t=0,e<0&&(r=!0,e=0-e),0===t)e=Math.round(e);else{var n=Math.pow(10,t);e*=n,e=Math.round(e),e/=n}return r?0-e:e}},{key:"unround",value:function(e){var r,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(isNaN(e))return 0;if(t=t||0,0===e)return 0;var n=e.toString();return t+(r=n.indexOf("."))<n.length?e:parseFloat(n.substr(0,r+t))}},{key:"calculate",value:function(e,r,t){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2;if(n||0===n||(n=6),e=e?"number"==typeof e?e.toString():e.replace(g._zeroRegex,""):0,r=r?"number"==typeof r?r.toString():r.replace(g._zeroRegex,""):0,!e||!r)switch(t){case"+":return g.parse(e||r);case"-":return e?g.parse(e):0-g.parse(r);default:return 0}var a,u,o,l,i=e.indexOf(".");return 0<i?(a=e.length-i-1,e=e.replace(".","")):a=0,0<(i=r.indexOf("."))?(u=r.length-i-1,r=r.replace(".","")):u=0,e=parseInt(e,10),r=parseInt(r,10),"+"===t||"-"===t?(o=(o=a-u)<0?(e*=Math.pow(10,0-o),u):(0<o&&(r*=Math.pow(10,o)),a),l="+"===t?e+r:e-r,n<o?l=Math.round(l/Math.pow(10,o-n)):n=o):l="*"===t?(o=a+u,l=e*r,Math.round(l/Math.pow(10,o-n))):u+n<a?Math.round(e/r/Math.pow(10,a-u-n)):a<u+n?Math.round(e*Math.pow(10,u+n-a)/r):Math.round(e/r),0===n?l:l/Math.pow(10,n)}},{key:"format",value:function(e,r){if(!1===_TypeHelper.default.isNumber(e)){if(!e)return"";if(!r)return String(e);e=g.parse(e)}if(!r)return e.toString();var t=r.split(";"),n=e<0;r=t[0],n&&2<=t.length&&(r=t[1]),0===e&&3<=t.length&&(r=t[2]);var a=-1!==r.indexOf("%"),u=g._isNumberFormat(r);e=a?100*Number(e):Number(e);var o=g._eRegExp.exec(r);if(o){var l=parseInt(o[2],10);return isNaN(l)?e.toExponential():e.toExponential(l)}if(!u)return r;var i="",f=g._getNumberFormat(r);return i=null!==f?(i=g._doFormatNumber(e,f.format),n&&(i="-"+i),r.substr(0,f.begin)+i+r.substr(f.end+1)):r}}]),g}();(exports.default=NumberHelper)._eRegExp=/^(e)(\d*)$/i,NumberHelper._clearRegExp=/[^0#]/g,NumberHelper._zeroRegex=/(,)|([0|.]*$)/g;
//# sourceMappingURL=NumberHelper.js.map
