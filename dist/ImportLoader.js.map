{"version":3,"sources":["ImportLoader.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","ImportLoader","url","id","arguments","length","undefined","protocol","_classCallCheck","this","indexOf","window","location","src","script","document","createElement","type","defer","buildScriptTag","p","onload","body","appendChild","getScriptPromise","concat","_callee","regeneratorRuntime","wrap","_context","prev","abrupt","getMainPromise","stop","mark","_callee2","_this","_context2","rejct","default","error"],"mappings":"ieAAA,IAAIA,UAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,OAAO,IAAKD,IAAMA,EAAIE,UAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,IAAW,MAAOG,GAAKL,EAAOK,IACpF,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAS,MAAUK,IAAW,MAAOG,GAAKL,EAAOK,IACvF,SAASF,EAAKI,GAAUA,EAAOC,KAAOT,EAAQQ,EAAOL,OAAS,IAAIN,EAAE,SAAUG,GAAWA,EAAQQ,EAAOL,SAAWO,KAAKR,EAAWK,GACnIH,GAAMN,EAAYA,EAAUa,MAAMhB,EAASC,GAAc,KAAKS,WAMjDO,wBATmD,SAAAA,EAACC,GAAU,IAAAC,EAAA,EAAAC,UAAAC,aAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAA,GAAAG,EAAA,EAAAH,UAAAC,OAAAD,UAAA,QAAAE,EAAAE,gBAAAC,KAAAR,GAAEX,KAAAA,SAAA,GAAYmB,KAAAP,IAAAA,EAAEO,KAAAN,GAAAA,EAoB5D,IAA3BM,KAAKP,IAAIQ,QAAQ,QAnBrBD,KAASb,SAATW,GAAyBI,OAAAC,SAAAL,UAAM,IAAAE,KAAAF,SAAAG,QAAA,OAAOvB,KAAAA,UAAmBK,kEAAqCqB,EAAAV,GA2B9F,IAAMW,EAASC,SAASC,cAAc,UAzBlC,OADJb,IAA8BW,EAANX,GAAcd,GAAmDA,EAAO4B,KAAO,kBAAzCH,EAA0DvB,OAA1D,EAAiFuB,EAAAI,OAAA,EAgC/IJ,EAAOD,IAAMA,EA/BP1B,2CALd0B,EAAAV,GAQA,IAAAW,EAAAL,KAAAU,eAAAN,EAAAV,GAiCciB,EAAI,IAAIhC,QAAQ,SAAAC,GAClByB,EAAOO,OAAS,WACZhC,EAAQoB,SAIhB,OADAM,SAASO,KAAKC,YAAYT,GACnBM,2CAGP,OAAOX,KAAKe,iBAAL,GAAAC,OAAyBhB,KAAKF,UAA9BkB,OAAyChB,KAAKP,KAAOO,KAAKN,mCAhCrE,OAAApB,UAAYmB,UAAwB,OAAA,EAAxBA,mBAAAA,KAAwB,SAAAwB,IAAA,OAAAC,mBAAAC,KAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAnC,MAAA,KAAA,EAAA,GAAA,oBAAAiB,OAAA,OAAAkB,EAAAE,OAAA,SAAA,MAAAF,EAAAnC,KAAA,EAAA,MAAA,KAAA,EAAA,OAAAmC,EAAAE,OAAA,SAAAtB,KAAAuB,kBAAA,KAAA,EAAA,IAAA,MAAA,OAAAH,EAAAI,SAAAP,EAAAjB,+CA6ChC,OAAO1B,UAAU0B,UAAM,OAAQ,EAAfkB,mBAAAO,KAAuB,SAAAC,IAAA,IAAAC,EAAA3B,KAAA,OAAAkB,mBAAAC,KAAA,SAAAS,GAAA,OAAA,OAAAA,EAAAP,KAAAO,EAAA3C,MAAA,KAAA,EAAA,GAzCnC,oBAASgB,OAyC0B,OAAA2B,EAAAN,OAAA,SAxCnBxB,MAwCmB8B,EAAA3C,KAAA,EAAA,MAAA,KAAA,EAAA,GAvC1Ba,OAAAA,QAuC0B,OAAA8B,EAAAN,OAAA,SAtC/B,IAAiB3C,QAAjB,SAAAC,EAAAiD,GACH3B,OAAA,QAAA,CAAA,GAAAc,OAAAW,EAAA7B,UAAAkB,OAAAW,EAAAlC,MAAA,SAAAL,GAERR,EADIQ,EACJA,EAAA0C,QA8C+B1C,IA5CbkB,SAAAA,GAEXuB,EAAAE,QA+BmCH,EAAA3C,KAAA,EAAA,MAAA,KAAA,EAAA,OAAA2C,EAAAN,OAAA,SA1BvC,MA0BuC,KAAA,EAAA,IAAA,MAAA,OAAAM,EAAAJ,SAAAE,EAAA1B","file":"ImportLoader.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/**\n * 引入外部js辅助类\n */\nexport default class ImportLoader {\n    /**\n     * 初始化 ImportLoader\n     * @param url 要引入的外部js文件\n     * @param id 脚本ID，防止重复加载\n     * @param protocol\n     */\n    constructor(url, id = \"\", protocol) {\n        this.protocol = \"\";\n        this.url = url;\n        this.id = id;\n        if (this.url.indexOf(\"//\") === 0) {\n            this.protocol = protocol || window.location.protocol;\n            if (this.protocol.indexOf(\":\") === -1) {\n                this.protocol += \":\";\n            }\n        }\n    }\n    buildScriptTag(src, id) {\n        const script = document.createElement(\"script\");\n        if (id)\n            script.id = id;\n        script.type = \"text/javascript\";\n        script.async = true;\n        script.defer = true;\n        script.src = src;\n        return script;\n    }\n    getScriptPromise(src, id) {\n        const script = this.buildScriptTag(src, id);\n        const p = new Promise(resolve => {\n            script.onload = function () {\n                resolve(this);\n            };\n        });\n        document.body.appendChild(script);\n        return p;\n    }\n    getMainPromise() {\n        return this.getScriptPromise(`${this.protocol}${this.url}`, this.id);\n    }\n    /** 加载外部js文件 */\n    load() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof window === \"undefined\") {\n                return null;\n            }\n            return this.getMainPromise();\n        });\n    }\n    /** 加载外部 AMD 具备默认导出的 js文件 */\n    loadDefault() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof window === \"undefined\") {\n                return null;\n            }\n            if (window[\"require\"]) {\n                return new Promise((resolve, rejct) => {\n                    window[\"require\"]([`${this.protocol}${this.url}`], result => {\n                        if (result) {\n                            resolve(result.default);\n                        }\n                        else {\n                            resolve(result);\n                        }\n                    }, error => {\n                        rejct(error);\n                    });\n                });\n            }\n            else {\n                return null;\n            }\n            // return this.getMainPromise()\n        });\n    }\n}\n"]}