{"version":3,"sources":["ImportLoader.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","trys","ops","verb","throw","return","Symbol","iterator","this","v","op","TypeError","call","label","pop","length","push","n","sent","ImportLoader","url","id","protocol","indexOf","window","location","prototype","buildScriptTag","src","script","createElement","type","async","defer","getScriptPromise","onload","appendChild","p","getMainPromise","load","_a","loadDefault","_this","rejct","default","error"],"mappings":"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","file":"ImportLoader.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/**\n * 引入外部js辅助类\n */\nvar ImportLoader = /** @class */ (function () {\n    /**\n     * 初始化 ImportLoader\n     * @param url 要引入的外部js文件\n     * @param id 脚本ID，防止重复加载\n     * @param protocol\n     */\n    function ImportLoader(url, id, protocol) {\n        if (id === void 0) { id = \"\"; }\n        this.protocol = \"\";\n        this.url = url;\n        this.id = id;\n        if (this.url.indexOf(\"//\") === 0) {\n            this.protocol = protocol || window.location.protocol;\n            if (this.protocol.indexOf(\":\") === -1) {\n                this.protocol += \":\";\n            }\n        }\n    }\n    ImportLoader.prototype.buildScriptTag = function (src, id) {\n        var script = document.createElement(\"script\");\n        if (id)\n            script.id = id;\n        script.type = \"text/javascript\";\n        script.async = true;\n        script.defer = true;\n        script.src = src;\n        return script;\n    };\n    ImportLoader.prototype.getScriptPromise = function (src, id) {\n        var script = this.buildScriptTag(src, id);\n        var p = new Promise(function (resolve) {\n            script.onload = function () {\n                resolve(this);\n            };\n        });\n        document.body.appendChild(script);\n        return p;\n    };\n    ImportLoader.prototype.getMainPromise = function () {\n        return this.getScriptPromise(\"\" + this.protocol + this.url, this.id);\n    };\n    /** 加载外部js文件 */\n    ImportLoader.prototype.load = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (typeof window === \"undefined\") {\n                    return [2 /*return*/, null];\n                }\n                return [2 /*return*/, this.getMainPromise()];\n            });\n        });\n    };\n    /** 加载外部 AMD 具备默认导出的 js文件 */\n    ImportLoader.prototype.loadDefault = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                if (typeof window === \"undefined\") {\n                    return [2 /*return*/, null];\n                }\n                if (window[\"require\"]) {\n                    return [2 /*return*/, new Promise(function (resolve, rejct) {\n                            window[\"require\"]([\"\" + _this.protocol + _this.url], function (result) {\n                                if (result) {\n                                    resolve(result.default);\n                                }\n                                else {\n                                    resolve(result);\n                                }\n                            }, function (error) {\n                                rejct(error);\n                            });\n                        })];\n                }\n                else {\n                    return [2 /*return*/, null];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    return ImportLoader;\n}());\nexport default ImportLoader;\n"]}